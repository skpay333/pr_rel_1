import{j as e}from"./react-vendor-DXh2JWUH.js";import{B as o,C as a}from"./card-l8B5EJfV.js";import{B as v}from"./badge-Dedo9uIt.js";import{u as k}from"./index-XvOZlhht.js";import{A as C,C as r,f as u,X as p,a as R,n as L,I as U,l as D,F as h,e as A}from"./icons-vendor-BKMeapAd.js";import"./ui-extended-CLSNRB24.js";import"./ui-core-DuOrk3UI.js";import"./utils-vendor-B2rm_Apj.js";import"./react-query-DV86JtqI.js";const F={submitted:"bg-blue-500 text-white",assigned:"bg-purple-500 text-white",processing:"bg-yellow-500 text-black",paid:"bg-green-500 text-white",rejected:"bg-red-500 text-white",cancelled:"bg-gray-400 text-white",pending:"bg-yellow-500 text-black",confirmed:"bg-green-500 text-white",expired:"bg-gray-400 text-white"},T={submitted:"ОТПРАВЛЕНА",assigned:"НАЗНАЧЕНА",processing:"В ОБРАБОТКЕ",paid:"ОПЛАЧЕНО",rejected:"ОТКЛОНЕНО",cancelled:"ОТМЕНЕНО",pending:"ОЖИДАНИЕ",confirmed:"ПОДТВЕРЖДЕНО",expired:"ИСТЕКЛО"},S={submitted:R,assigned:r,processing:r,paid:u,rejected:p,cancelled:p,pending:r,confirmed:u,expired:r};function H({request:t,onBack:g,onCancelRequest:f}){const{toast:i}=k(),b=()=>{f(t.id),i({title:"Заявка отменена",description:"Средства возвращены на баланс."})},j=()=>{if(!t.receipt)return;const s=t.receipt.mimeType,l=t.receipt.value,N=t.receipt.name,c=atob(l),m=new Array(c.length);for(let n=0;n<c.length;n++)m[n]=c.charCodeAt(n);const w=new Uint8Array(m),y=new Blob([w],{type:s}),x=window.URL.createObjectURL(y),d=document.createElement("a");d.href=x,d.download=N,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(x),i({title:"Успешно",description:"Чек загружен"})};return e.jsx("div",{className:"flex flex-col min-h-[calc(100vh-4rem)] px-6 pt-8 pb-28 bg-background",children:e.jsxs("div",{className:"max-w-md w-full mx-auto space-y-6",children:[e.jsxs(o,{variant:"ghost",onClick:g,className:"gap-2 -ml-2 font-medium","data-testid":"button-back",children:[e.jsx(C,{className:"w-4 h-4"}),"Назад"]}),e.jsxs("h1",{className:"text-3xl font-bold text-foreground",children:["Заявка №",t.id.slice(-6)]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(a,{className:"p-6 shadow-card gradient-card rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Сумма"}),e.jsxs("p",{className:"text-3xl font-bold text-foreground tabular-nums",children:[t.amountRub.toLocaleString("ru-RU")," ₽"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Эквивалент в USDT"}),e.jsxs("p",{className:"text-3xl font-bold text-foreground tabular-nums",children:[t.usdtFrozen.toFixed(2)," USDT"]})]})]})}),e.jsxs(a,{className:"p-6 shadow-card gradient-card rounded-lg space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-bold text-muted-foreground",children:"Статус"}),e.jsxs(v,{className:`${F[t.status]} no-default-hover-elevate no-default-active-elevate font-bold px-3 py-1.5 rounded-md shadow-sm flex items-center gap-1.5`,children:[(()=>{const s=S[t.status];return e.jsx(s,{className:"w-3.5 h-3.5"})})(),T[t.status]]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-bold text-muted-foreground",children:"Срочность"}),e.jsx("span",{className:"text-sm font-bold text-foreground",children:t.urgency==="urgent"?"Срочно":"Стандартно"})]}),t.urgency==="standard"&&e.jsx("p",{className:"text-xs text-green-600 dark:text-green-500 pt-3 border-t font-medium",children:"✓ Курс на 0,5% выгоднее."})]}),e.jsxs(a,{className:"p-6 shadow-card gradient-card rounded-lg space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-bold text-muted-foreground",children:"Использованный курс"}),e.jsxs("span",{className:"text-sm font-bold text-foreground tabular-nums",children:[t.frozenRate.toFixed(2)," ₽"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm font-bold text-muted-foreground flex items-center gap-1",children:[e.jsx(L,{className:"w-3.5 h-3.5"}),"Заморожено на балансе"]}),e.jsxs("span",{className:"text-sm font-bold text-foreground tabular-nums",children:[t.usdtFrozen.toFixed(2)," USDT"]})]})]}),t.attachments&&t.attachments.length>0&&e.jsxs(a,{className:"p-6 shadow-card gradient-card rounded-lg",children:[e.jsx("p",{className:"text-sm font-bold text-muted-foreground mb-4",children:"Вложение"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.attachments.map((s,l)=>e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted/50 rounded-lg",children:[s.type==="image"&&e.jsx(U,{className:"w-4 h-4 text-muted-foreground"}),s.type==="link"&&e.jsx(D,{className:"w-4 h-4 text-muted-foreground"}),s.type==="pdf"&&e.jsx(h,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm truncate max-w-[150px]",children:s.name||s.value})]},l))})]}),e.jsxs(a,{className:"p-5 shadow-md rounded-2xl",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Комментарий"}),e.jsx("p",{className:"text-sm text-foreground",children:t.comment||"—"})]}),e.jsxs(a,{className:"p-5 shadow-md rounded-2xl",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Создано"}),e.jsx("p",{className:"text-sm text-foreground",children:new Date(t.createdAt).toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})]}),t.receipt&&e.jsxs(a,{className:"p-6 shadow-card gradient-card rounded-lg",children:[e.jsx("p",{className:"text-sm font-bold text-muted-foreground mb-4",children:"Чек оплаты"}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(h,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:t.receipt.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t.receipt.type==="pdf"?"PDF документ":"Изображение"})]})]}),e.jsxs(o,{onClick:j,variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Скачать"]})]})]}),t.status==="submitted"&&e.jsx(o,{onClick:b,variant:"outline",className:"w-full min-h-[52px] rounded-lg font-bold text-destructive hover:text-destructive","data-testid":"button-cancel-request",children:"Отменить заявку"})]})]})})}export{H as default};
