import{R as j,r as P,j as n}from"./react-vendor-DXh2JWUH.js";import{B as I,C as z}from"./card-l8B5EJfV.js";import{I as ve}from"./input-BK4KRhIb.js";import{L as ye}from"./label-CgwsQBad.js";import{A as J,a as ee,b as te,c as se,d as re,e as ne,g as oe,f as Me}from"./alert-dialog-B07NitoX.js";import{u as je,A as Re,B as Se,h as De,C as Pe}from"./index-XvOZlhht.js";import{A as le,L as Ie,a as ie,C as Le,i as ae,f as Te,E as Oe,c as Fe}from"./icons-vendor-BKMeapAd.js";import"./ui-extended-CLSNRB24.js";import"./ui-core-DuOrk3UI.js";import"./utils-vendor-B2rm_Apj.js";import"./react-query-DV86JtqI.js";var Ue=Object.defineProperty,W=Object.getOwnPropertySymbols,de=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable,ce=(d,a,l)=>a in d?Ue(d,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):d[a]=l,K=(d,a)=>{for(var l in a||(a={}))de.call(a,l)&&ce(d,l,a[l]);if(W)for(var l of W(a))ue.call(a,l)&&ce(d,l,a[l]);return d},Z=(d,a)=>{var l={};for(var u in d)de.call(d,u)&&a.indexOf(u)<0&&(l[u]=d[u]);if(d!=null&&W)for(var u of W(d))a.indexOf(u)<0&&ue.call(d,u)&&(l[u]=d[u]);return l};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var F;(d=>{const a=class x{constructor(e,s,t,r){if(this.version=e,this.errorCorrectionLevel=s,this.modules=[],this.isFunction=[],e<x.MIN_VERSION||e>x.MAX_VERSION)throw new RangeError("Version value out of range");if(r<-1||r>7)throw new RangeError("Mask value out of range");this.size=e*4+17;let o=[];for(let i=0;i<this.size;i++)o.push(!1);for(let i=0;i<this.size;i++)this.modules.push(o.slice()),this.isFunction.push(o.slice());this.drawFunctionPatterns();const c=this.addEccAndInterleave(t);if(this.drawCodewords(c),r==-1){let i=1e9;for(let g=0;g<8;g++){this.applyMask(g),this.drawFormatBits(g);const m=this.getPenaltyScore();m<i&&(r=g,i=m),this.applyMask(g)}}f(0<=r&&r<=7),this.mask=r,this.applyMask(r),this.drawFormatBits(r),this.isFunction=[]}static encodeText(e,s){const t=d.QrSegment.makeSegments(e);return x.encodeSegments(t,s)}static encodeBinary(e,s){const t=d.QrSegment.makeBytes(e);return x.encodeSegments([t],s)}static encodeSegments(e,s,t=1,r=40,o=-1,c=!0){if(!(x.MIN_VERSION<=t&&t<=r&&r<=x.MAX_VERSION)||o<-1||o>7)throw new RangeError("Invalid value");let i,g;for(i=t;;i++){const p=x.getNumDataCodewords(i,s)*8,E=A.getTotalBits(e,i);if(E<=p){g=E;break}if(i>=r)throw new RangeError("Data too long")}for(const p of[x.Ecc.MEDIUM,x.Ecc.QUARTILE,x.Ecc.HIGH])c&&g<=x.getNumDataCodewords(i,p)*8&&(s=p);let m=[];for(const p of e){l(p.mode.modeBits,4,m),l(p.numChars,p.mode.numCharCountBits(i),m);for(const E of p.getData())m.push(E)}f(m.length==g);const R=x.getNumDataCodewords(i,s)*8;f(m.length<=R),l(0,Math.min(4,R-m.length),m),l(0,(8-m.length%8)%8,m),f(m.length%8==0);for(let p=236;m.length<R;p^=253)l(p,8,m);let y=[];for(;y.length*8<m.length;)y.push(0);return m.forEach((p,E)=>y[E>>>3]|=p<<7-(E&7)),new x(i,s,y,o)}getModule(e,s){return 0<=e&&e<this.size&&0<=s&&s<this.size&&this.modules[s][e]}getModules(){return this.modules}drawFunctionPatterns(){for(let t=0;t<this.size;t++)this.setFunctionModule(6,t,t%2==0),this.setFunctionModule(t,6,t%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const e=this.getAlignmentPatternPositions(),s=e.length;for(let t=0;t<s;t++)for(let r=0;r<s;r++)t==0&&r==0||t==0&&r==s-1||t==s-1&&r==0||this.drawAlignmentPattern(e[t],e[r]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){const s=this.errorCorrectionLevel.formatBits<<3|e;let t=s;for(let o=0;o<10;o++)t=t<<1^(t>>>9)*1335;const r=(s<<10|t)^21522;f(r>>>15==0);for(let o=0;o<=5;o++)this.setFunctionModule(8,o,u(r,o));this.setFunctionModule(8,7,u(r,6)),this.setFunctionModule(8,8,u(r,7)),this.setFunctionModule(7,8,u(r,8));for(let o=9;o<15;o++)this.setFunctionModule(14-o,8,u(r,o));for(let o=0;o<8;o++)this.setFunctionModule(this.size-1-o,8,u(r,o));for(let o=8;o<15;o++)this.setFunctionModule(8,this.size-15+o,u(r,o));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let t=0;t<12;t++)e=e<<1^(e>>>11)*7973;const s=this.version<<12|e;f(s>>>18==0);for(let t=0;t<18;t++){const r=u(s,t),o=this.size-11+t%3,c=Math.floor(t/3);this.setFunctionModule(o,c,r),this.setFunctionModule(c,o,r)}}drawFinderPattern(e,s){for(let t=-4;t<=4;t++)for(let r=-4;r<=4;r++){const o=Math.max(Math.abs(r),Math.abs(t)),c=e+r,i=s+t;0<=c&&c<this.size&&0<=i&&i<this.size&&this.setFunctionModule(c,i,o!=2&&o!=4)}}drawAlignmentPattern(e,s){for(let t=-2;t<=2;t++)for(let r=-2;r<=2;r++)this.setFunctionModule(e+r,s+t,Math.max(Math.abs(r),Math.abs(t))!=1)}setFunctionModule(e,s,t){this.modules[s][e]=t,this.isFunction[s][e]=!0}addEccAndInterleave(e){const s=this.version,t=this.errorCorrectionLevel;if(e.length!=x.getNumDataCodewords(s,t))throw new RangeError("Invalid argument");const r=x.NUM_ERROR_CORRECTION_BLOCKS[t.ordinal][s],o=x.ECC_CODEWORDS_PER_BLOCK[t.ordinal][s],c=Math.floor(x.getNumRawDataModules(s)/8),i=r-c%r,g=Math.floor(c/r);let m=[];const R=x.reedSolomonComputeDivisor(o);for(let p=0,E=0;p<r;p++){let v=e.slice(E,E+g-o+(p<i?0:1));E+=v.length;const U=x.reedSolomonComputeRemainder(v,R);p<i&&v.push(0),m.push(v.concat(U))}let y=[];for(let p=0;p<m[0].length;p++)m.forEach((E,v)=>{(p!=g-o||v>=i)&&y.push(E[p])});return f(y.length==c),y}drawCodewords(e){if(e.length!=Math.floor(x.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let s=0;for(let t=this.size-1;t>=1;t-=2){t==6&&(t=5);for(let r=0;r<this.size;r++)for(let o=0;o<2;o++){const c=t-o,g=(t+1&2)==0?this.size-1-r:r;!this.isFunction[g][c]&&s<e.length*8&&(this.modules[g][c]=u(e[s>>>3],7-(s&7)),s++)}}f(s==e.length*8)}applyMask(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(let s=0;s<this.size;s++)for(let t=0;t<this.size;t++){let r;switch(e){case 0:r=(t+s)%2==0;break;case 1:r=s%2==0;break;case 2:r=t%3==0;break;case 3:r=(t+s)%3==0;break;case 4:r=(Math.floor(t/3)+Math.floor(s/2))%2==0;break;case 5:r=t*s%2+t*s%3==0;break;case 6:r=(t*s%2+t*s%3)%2==0;break;case 7:r=((t+s)%2+t*s%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[s][t]&&r&&(this.modules[s][t]=!this.modules[s][t])}}getPenaltyScore(){let e=0;for(let o=0;o<this.size;o++){let c=!1,i=0,g=[0,0,0,0,0,0,0];for(let m=0;m<this.size;m++)this.modules[o][m]==c?(i++,i==5?e+=x.PENALTY_N1:i>5&&e++):(this.finderPenaltyAddHistory(i,g),c||(e+=this.finderPenaltyCountPatterns(g)*x.PENALTY_N3),c=this.modules[o][m],i=1);e+=this.finderPenaltyTerminateAndCount(c,i,g)*x.PENALTY_N3}for(let o=0;o<this.size;o++){let c=!1,i=0,g=[0,0,0,0,0,0,0];for(let m=0;m<this.size;m++)this.modules[m][o]==c?(i++,i==5?e+=x.PENALTY_N1:i>5&&e++):(this.finderPenaltyAddHistory(i,g),c||(e+=this.finderPenaltyCountPatterns(g)*x.PENALTY_N3),c=this.modules[m][o],i=1);e+=this.finderPenaltyTerminateAndCount(c,i,g)*x.PENALTY_N3}for(let o=0;o<this.size-1;o++)for(let c=0;c<this.size-1;c++){const i=this.modules[o][c];i==this.modules[o][c+1]&&i==this.modules[o+1][c]&&i==this.modules[o+1][c+1]&&(e+=x.PENALTY_N2)}let s=0;for(const o of this.modules)s=o.reduce((c,i)=>c+(i?1:0),s);const t=this.size*this.size,r=Math.ceil(Math.abs(s*20-t*10)/t)-1;return f(0<=r&&r<=9),e+=r*x.PENALTY_N4,f(0<=e&&e<=2568888),e}getAlignmentPatternPositions(){if(this.version==1)return[];{const e=Math.floor(this.version/7)+2,s=this.version==32?26:Math.ceil((this.version*4+4)/(e*2-2))*2;let t=[6];for(let r=this.size-7;t.length<e;r-=s)t.splice(1,0,r);return t}}static getNumRawDataModules(e){if(e<x.MIN_VERSION||e>x.MAX_VERSION)throw new RangeError("Version number out of range");let s=(16*e+128)*e+64;if(e>=2){const t=Math.floor(e/7)+2;s-=(25*t-10)*t-55,e>=7&&(s-=36)}return f(208<=s&&s<=29648),s}static getNumDataCodewords(e,s){return Math.floor(x.getNumRawDataModules(e)/8)-x.ECC_CODEWORDS_PER_BLOCK[s.ordinal][e]*x.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][e]}static reedSolomonComputeDivisor(e){if(e<1||e>255)throw new RangeError("Degree out of range");let s=[];for(let r=0;r<e-1;r++)s.push(0);s.push(1);let t=1;for(let r=0;r<e;r++){for(let o=0;o<s.length;o++)s[o]=x.reedSolomonMultiply(s[o],t),o+1<s.length&&(s[o]^=s[o+1]);t=x.reedSolomonMultiply(t,2)}return s}static reedSolomonComputeRemainder(e,s){let t=s.map(r=>0);for(const r of e){const o=r^t.shift();t.push(0),s.forEach((c,i)=>t[i]^=x.reedSolomonMultiply(c,o))}return t}static reedSolomonMultiply(e,s){if(e>>>8||s>>>8)throw new RangeError("Byte out of range");let t=0;for(let r=7;r>=0;r--)t=t<<1^(t>>>7)*285,t^=(s>>>r&1)*e;return f(t>>>8==0),t}finderPenaltyCountPatterns(e){const s=e[1];f(s<=this.size*3);const t=s>0&&e[2]==s&&e[3]==s*3&&e[4]==s&&e[5]==s;return(t&&e[0]>=s*4&&e[6]>=s?1:0)+(t&&e[6]>=s*4&&e[0]>=s?1:0)}finderPenaltyTerminateAndCount(e,s,t){return e&&(this.finderPenaltyAddHistory(s,t),s=0),s+=this.size,this.finderPenaltyAddHistory(s,t),this.finderPenaltyCountPatterns(t)}finderPenaltyAddHistory(e,s){s[0]==0&&(e+=this.size),s.pop(),s.unshift(e)}};a.MIN_VERSION=1,a.MAX_VERSION=40,a.PENALTY_N1=3,a.PENALTY_N2=3,a.PENALTY_N3=40,a.PENALTY_N4=10,a.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],a.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],d.QrCode=a;function l(b,e,s){if(e<0||e>31||b>>>e)throw new RangeError("Value out of range");for(let t=e-1;t>=0;t--)s.push(b>>>t&1)}function u(b,e){return(b>>>e&1)!=0}function f(b){if(!b)throw new Error("Assertion error")}const h=class M{constructor(e,s,t){if(this.mode=e,this.numChars=s,this.bitData=t,s<0)throw new RangeError("Invalid argument");this.bitData=t.slice()}static makeBytes(e){let s=[];for(const t of e)l(t,8,s);return new M(M.Mode.BYTE,e.length,s)}static makeNumeric(e){if(!M.isNumeric(e))throw new RangeError("String contains non-numeric characters");let s=[];for(let t=0;t<e.length;){const r=Math.min(e.length-t,3);l(parseInt(e.substring(t,t+r),10),r*3+1,s),t+=r}return new M(M.Mode.NUMERIC,e.length,s)}static makeAlphanumeric(e){if(!M.isAlphanumeric(e))throw new RangeError("String contains unencodable characters in alphanumeric mode");let s=[],t;for(t=0;t+2<=e.length;t+=2){let r=M.ALPHANUMERIC_CHARSET.indexOf(e.charAt(t))*45;r+=M.ALPHANUMERIC_CHARSET.indexOf(e.charAt(t+1)),l(r,11,s)}return t<e.length&&l(M.ALPHANUMERIC_CHARSET.indexOf(e.charAt(t)),6,s),new M(M.Mode.ALPHANUMERIC,e.length,s)}static makeSegments(e){return e==""?[]:M.isNumeric(e)?[M.makeNumeric(e)]:M.isAlphanumeric(e)?[M.makeAlphanumeric(e)]:[M.makeBytes(M.toUtf8ByteArray(e))]}static makeEci(e){let s=[];if(e<0)throw new RangeError("ECI assignment value out of range");if(e<128)l(e,8,s);else if(e<16384)l(2,2,s),l(e,14,s);else if(e<1e6)l(6,3,s),l(e,21,s);else throw new RangeError("ECI assignment value out of range");return new M(M.Mode.ECI,0,s)}static isNumeric(e){return M.NUMERIC_REGEX.test(e)}static isAlphanumeric(e){return M.ALPHANUMERIC_REGEX.test(e)}getData(){return this.bitData.slice()}static getTotalBits(e,s){let t=0;for(const r of e){const o=r.mode.numCharCountBits(s);if(r.numChars>=1<<o)return 1/0;t+=4+o+r.bitData.length}return t}static toUtf8ByteArray(e){e=encodeURI(e);let s=[];for(let t=0;t<e.length;t++)e.charAt(t)!="%"?s.push(e.charCodeAt(t)):(s.push(parseInt(e.substring(t+1,t+3),16)),t+=2);return s}};h.NUMERIC_REGEX=/^[0-9]*$/,h.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,h.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let A=h;d.QrSegment=h})(F||(F={}));(d=>{(a=>{const l=class{constructor(f,h){this.ordinal=f,this.formatBits=h}};l.LOW=new l(0,1),l.MEDIUM=new l(1,0),l.QUARTILE=new l(2,3),l.HIGH=new l(3,2),a.Ecc=l})(d.QrCode||(d.QrCode={}))})(F||(F={}));(d=>{(a=>{const l=class{constructor(f,h){this.modeBits=f,this.numBitsCharCount=h}numCharCountBits(f){return this.numBitsCharCount[Math.floor((f+7)/17)]}};l.NUMERIC=new l(1,[10,12,14]),l.ALPHANUMERIC=new l(2,[9,11,13]),l.BYTE=new l(4,[8,16,16]),l.KANJI=new l(8,[8,10,12]),l.ECI=new l(7,[0,0,0]),a.Mode=l})(d.QrSegment||(d.QrSegment={}))})(F||(F={}));var B=F;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var ze={L:B.QrCode.Ecc.LOW,M:B.QrCode.Ecc.MEDIUM,Q:B.QrCode.Ecc.QUARTILE,H:B.QrCode.Ecc.HIGH},he=128,me="L",fe="#FFFFFF",ge="#000000",pe=!1,xe=1,Be=4,ke=0,_e=.1;function we(d,a=0){const l=[];return d.forEach(function(u,f){let h=null;u.forEach(function(A,b){if(!A&&h!==null){l.push(`M${h+a} ${f+a}h${b-h}v1H${h+a}z`),h=null;return}if(b===u.length-1){if(!A)return;h===null?l.push(`M${b+a},${f+a} h1v1H${b+a}z`):l.push(`M${h+a},${f+a} h${b+1-h}v1H${h+a}z`);return}A&&h===null&&(h=b)})}),l.join("")}function Ne(d,a){return d.slice().map((l,u)=>u<a.y||u>=a.y+a.h?l:l.map((f,h)=>h<a.x||h>=a.x+a.w?f:!1))}function $e(d,a,l,u){if(u==null)return null;const f=d.length+l*2,h=Math.floor(a*_e),A=f/a,b=(u.width||h)*A,e=(u.height||h)*A,s=u.x==null?d.length/2-b/2:u.x*A,t=u.y==null?d.length/2-e/2:u.y*A,r=u.opacity==null?1:u.opacity;let o=null;if(u.excavate){let i=Math.floor(s),g=Math.floor(t),m=Math.ceil(b+s-i),R=Math.ceil(e+t-g);o={x:i,y:g,w:m,h:R}}const c=u.crossOrigin;return{x:s,y:t,h:e,w:b,excavation:o,opacity:r,crossOrigin:c}}function Qe(d,a){return a!=null?Math.max(Math.floor(a),0):d?Be:ke}function be({value:d,level:a,minVersion:l,includeMargin:u,marginSize:f,imageSettings:h,size:A,boostLevel:b}){let e=j.useMemo(()=>{const i=(Array.isArray(d)?d:[d]).reduce((g,m)=>(g.push(...B.QrSegment.makeSegments(m)),g),[]);return B.QrCode.encodeSegments(i,ze[a],l,void 0,void 0,b)},[d,a,l,b]);const{cells:s,margin:t,numCells:r,calculatedImageSettings:o}=j.useMemo(()=>{let c=e.getModules();const i=Qe(u,f),g=c.length+i*2,m=$e(c,A,i,h);return{cells:c,margin:i,numCells:g,calculatedImageSettings:m}},[e,A,h,u,f]);return{qrcode:e,margin:t,cells:s,numCells:r,calculatedImageSettings:o}}var He=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),Ge=j.forwardRef(function(a,l){const u=a,{value:f,size:h=he,level:A=me,bgColor:b=fe,fgColor:e=ge,includeMargin:s=pe,minVersion:t=xe,boostLevel:r,marginSize:o,imageSettings:c}=u,g=Z(u,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:m}=g,R=Z(g,["style"]),y=c==null?void 0:c.src,p=j.useRef(null),E=j.useRef(null),v=j.useCallback(L=>{p.current=L,typeof l=="function"?l(L):l&&(l.current=L)},[l]),[U,k]=j.useState(!1),{margin:T,cells:_,numCells:$,calculatedImageSettings:S}=be({value:f,level:A,minVersion:t,boostLevel:r,includeMargin:s,marginSize:o,imageSettings:c,size:h});j.useEffect(()=>{if(p.current!=null){const L=p.current,D=L.getContext("2d");if(!D)return;let V=_;const O=E.current,w=S!=null&&O!==null&&O.complete&&O.naturalHeight!==0&&O.naturalWidth!==0;w&&S.excavation!=null&&(V=Ne(_,S.excavation));const C=window.devicePixelRatio||1;L.height=L.width=h*C;const N=h/$*C;D.scale(N,N),D.fillStyle=b,D.fillRect(0,0,$,$),D.fillStyle=e,He?D.fill(new Path2D(we(V,T))):_.forEach(function(Q,X){Q.forEach(function(Ee,Ae){Ee&&D.fillRect(Ae+T,X+T,1,1)})}),S&&(D.globalAlpha=S.opacity),w&&D.drawImage(O,S.x+T,S.y+T,S.w,S.h)}}),j.useEffect(()=>{k(!1)},[y]);const q=K({height:h,width:h},m);let Y=null;return y!=null&&(Y=j.createElement("img",{src:y,key:y,style:{display:"none"},onLoad:()=>{k(!0)},ref:E,crossOrigin:S==null?void 0:S.crossOrigin})),j.createElement(j.Fragment,null,j.createElement("canvas",K({style:q,height:h,width:h,ref:v,role:"img"},R)),Y)});Ge.displayName="QRCodeCanvas";var Ce=j.forwardRef(function(a,l){const u=a,{value:f,size:h=he,level:A=me,bgColor:b=fe,fgColor:e=ge,includeMargin:s=pe,minVersion:t=xe,boostLevel:r,title:o,marginSize:c,imageSettings:i}=u,g=Z(u,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:m,cells:R,numCells:y,calculatedImageSettings:p}=be({value:f,level:A,minVersion:t,boostLevel:r,includeMargin:s,marginSize:c,imageSettings:i,size:h});let E=R,v=null;i!=null&&p!=null&&(p.excavation!=null&&(E=Ne(R,p.excavation)),v=j.createElement("image",{href:i.src,height:p.h,width:p.w,x:p.x+m,y:p.y+m,preserveAspectRatio:"none",opacity:p.opacity,crossOrigin:p.crossOrigin}));const U=we(E,m);return j.createElement("svg",K({height:h,width:h,viewBox:`0 0 ${y} ${y}`,ref:l,role:"img"},g),!!o&&j.createElement("title",null,o),j.createElement("path",{fill:b,d:`M0,0 h${y}v${y}H0z`,shapeRendering:"crispEdges"}),j.createElement("path",{fill:e,d:U,shapeRendering:"crispEdges"}),v)});Ce.displayName="QRCodeSVG";const H=30,G=2e4;function ot({userId:d,depositId:a,onBack:l,onTopUpComplete:u,onNavigateToHistory:f}){const[h,A]=P.useState("input"),[b,e]=P.useState(""),[s,t]=P.useState(!1),[r,o]=P.useState(null),[c,i]=P.useState(!1),[g,m]=P.useState(600),[R,y]=P.useState(!1),[p,E]=P.useState(!1),{toast:v}=je();P.useEffect(()=>{async function w(){if(a&&d)try{const N=(await Re(d)).find(Q=>Q.id===a);N&&(o({id:N.id,walletAddress:N.walletAddress||"THVyqrSDMBvpibitvTt4xJFWxVgY61acLu",requestedAmount:N.requestedAmount||N.amount,payableAmount:N.payableAmount||N.amount,expiresAt:N.expiresAt||new Date().toISOString(),status:N.status,createdAt:N.createdAt}),e(Number(N.requestedAmount||N.amount).toString()),A("qr"))}catch(C){console.error("Error loading deposit:",C),v({title:"Ошибка",description:"Не удалось загрузить заявку",variant:"destructive"})}}w()},[a,d,v]),P.useEffect(()=>{if(h==="qr"&&r&&r.status==="pending"&&r.expiresAt){const w=new Date(r.expiresAt).getTime(),C=Date.now();if(w>C){const N=setInterval(()=>{const Q=Date.now(),X=Math.max(0,Math.floor((w-Q)/1e3));m(X),X===0&&(clearInterval(N),v({title:"Время истекло",description:"Депозит истек. Создайте новую заявку.",variant:"destructive"}),setTimeout(()=>{A("input"),o(null),e(""),f?f():l()},2e3))},1e3);return()=>clearInterval(N)}}},[h,r,v,f,l]);const U=w=>{const C=Math.floor(w/60),N=w%60;return`${C}:${N.toString().padStart(2,"0")}`},k=w=>{const C=parseFloat(w);return!(isNaN(C)||C<H||C>G)},T=async()=>{if(!d){v({title:"Ошибка",description:"Пользователь не авторизован",variant:"destructive"});return}const w=parseFloat(b);if(!k(b)){v({title:"Ошибка",description:`Сумма должна быть от ${H} до ${G} USDT`,variant:"destructive"});return}t(!0);try{const C=await Se(d,w);o(C),A("qr"),v({title:"Депозит создан",description:`Переведите ровно ${De(C.payableAmount)} USDT`})}catch(C){const N=C instanceof Error?C.message:"Не удалось создать депозит";N.includes("уже открыто")&&N.includes("заявки на пополнение")?E(!0):v({title:"Ошибка",description:N,variant:"destructive"})}finally{t(!1)}},_=()=>{r&&(navigator.clipboard.writeText(r.walletAddress),i(!0),setTimeout(()=>i(!1),2e3))},$=()=>{r&&(navigator.clipboard.writeText(Number(r.payableAmount).toFixed(2)),v({title:"Скопировано",description:"Сумма скопирована в буфер обмена"}))},S=()=>{if(r){const w=`https://tronscan.org/#/address/${r.walletAddress}/transfers`;window.open(w,"_blank")}},q=()=>{y(!0)},Y=()=>{u&&r&&u(Number(r.requestedAmount)),y(!1),l()},L=async()=>{if(r)try{await Pe(r.id),v({title:"Заявка отменена",description:"Депозит успешно отменен"}),A("input"),o(null),e(""),f?f():l()}catch(w){v({title:"Ошибка",description:w instanceof Error?w.message:"Не удалось отменить заявку",variant:"destructive"})}},D=async()=>{d&&(A("input"),o(null),e(""))},V=w=>{switch(w){case"confirmed":return{title:"Депозит подтвержден",color:"green",icon:"✅"};case"cancelled":return{title:"Депозит отменен",color:"red",icon:"❌"};case"expired":return{title:"Депозит истек",color:"orange",icon:"⏰"};default:return null}},O=w=>{if(!w||w.status!=="pending"||!w.expiresAt)return!1;const C=new Date;return new Date(w.expiresAt)>C};if(h==="input")return n.jsx("div",{className:"flex flex-col min-h-[calc(100vh-4rem)] px-6 pt-8 pb-28 bg-background",children:n.jsxs("div",{className:"max-w-md w-full mx-auto space-y-6",children:[n.jsxs(I,{variant:"ghost",onClick:l,className:"gap-2 -ml-2 font-medium",children:[n.jsx(le,{className:"w-4 h-4"}),"Назад"]}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Пополнить баланс"}),n.jsx("p",{className:"text-muted-foreground mt-2 font-medium",children:"Введите сумму пополнения"})]}),n.jsxs(z,{className:"p-6 space-y-4 shadow-card gradient-card rounded-lg",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(ye,{htmlFor:"amount",className:"font-bold",children:"Сумма пополнения (USDT)"}),n.jsx(ve,{id:"amount",type:"number",step:"0.01",min:H,max:G,placeholder:`От ${H} до ${G} USDT`,value:b,onChange:w=>e(w.target.value),className:"font-medium text-lg"}),n.jsxs("p",{className:"text-xs text-muted-foreground",children:["Минимум: ",H," USDT • Максимум: ",G.toLocaleString()," USDT"]})]}),n.jsx(I,{onClick:T,className:"w-full gap-2 min-h-[52px] rounded-xl gradient-primary text-white font-bold shadow-premium",disabled:s||!b||!k(b),children:s?n.jsxs(n.Fragment,{children:[n.jsx(Ie,{className:"w-4 h-4 animate-spin"}),"Создание депозита..."]}):"Продолжить"})]}),n.jsx(z,{className:"p-4 bg-blue-50 border-blue-200 rounded-2xl",children:n.jsxs("div",{className:"flex gap-3",children:[n.jsx(ie,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{className:"text-sm text-blue-900",children:[n.jsx("p",{className:"font-semibold mb-1",children:"Как это работает:"}),n.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[n.jsx("li",{children:"Вы указываете желаемую сумму"}),n.jsx("li",{children:"Система создаёт уникальную заявку с точной суммой для перевода"}),n.jsx("li",{children:"Вы переводите USDT (TRC20) на указанный адрес"}),n.jsx("li",{children:"Система автоматически зачисляет средства после подтверждения в блокчейне"})]})]})]})})]})});if(h==="qr"&&r){const w=g<=120,C=O(r),N=V(r.status);return n.jsxs("div",{className:"flex flex-col min-h-[calc(100vh-4rem)] px-6 pt-8 pb-28 bg-background",children:[n.jsxs("div",{className:"max-w-md w-full mx-auto space-y-6",children:[n.jsxs(I,{variant:"ghost",onClick:l,className:"gap-2 -ml-2 font-medium",children:[n.jsx(le,{className:"w-4 h-4"}),"Назад"]}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-foreground",children:C?"Переведите USDT":"Информация о депозите"}),n.jsx("p",{className:"text-muted-foreground mt-2 font-medium",children:C?"Отправьте точную сумму на адрес ниже":"Просмотр деталей депозита"})]}),N&&n.jsx(z,{className:`p-6 shadow-card rounded-lg border-2 ${N.color==="green"?"border-green-500 bg-green-50":N.color==="red"?"border-red-500 bg-red-50":"border-orange-500 bg-orange-50"}`,children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"text-3xl",children:N.icon}),n.jsxs("div",{children:[n.jsx("p",{className:`text-lg font-bold ${N.color==="green"?"text-green-700":N.color==="red"?"text-red-700":"text-orange-700"}`,children:N.title}),n.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Дата создания: ",new Date(r.createdAt).toLocaleString("ru-RU")]})]})]})}),C&&n.jsxs(z,{className:`p-6 space-y-4 shadow-card rounded-lg border-2 ${w?"border-red-500 bg-red-50":"border-green-500 bg-green-50"}`,children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Le,{className:`w-5 h-5 ${w?"text-red-600":"text-green-600"}`}),n.jsx("span",{className:"font-bold text-sm",children:"Время на оплату:"})]}),n.jsx("span",{className:`text-2xl font-bold ${w?"text-red-600":"text-green-600"}`,children:U(g)})]}),w&&n.jsx("p",{className:"text-sm text-red-700 font-medium",children:"⚠️ Поторопитесь! Депозит скоро истечёт"})]}),n.jsxs(z,{className:"p-6 space-y-5 shadow-card gradient-card rounded-lg",children:[n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("p",{className:"text-sm font-bold text-muted-foreground",children:"Сеть:"}),n.jsx("p",{className:"text-sm font-bold text-foreground",children:"USDT TRC20"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("p",{className:"text-sm font-bold text-muted-foreground",children:"К зачислению:"}),n.jsxs("p",{className:"text-sm font-bold text-foreground",children:[Number(r.payableAmount).toFixed(2)," USDT"]})]})]}),C?n.jsxs("div",{className:"bg-gradient-to-br from-yellow-100 to-yellow-200 border-2 border-yellow-500 rounded-lg p-4 space-y-2",children:[n.jsx("p",{className:"text-xs font-bold text-yellow-900 uppercase",children:"⚡ Переведите точно:"}),n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsx("p",{className:"text-3xl font-bold text-yellow-900 font-mono",children:Number(r.payableAmount).toFixed(2)}),n.jsx(I,{size:"sm",onClick:$,variant:"outline",className:"bg-white border-yellow-500 hover:bg-yellow-50",children:n.jsx(ae,{className:"w-4 h-4"})})]}),n.jsx("p",{className:"text-xs text-yellow-800",children:"Система автоматически зачислит средства при получении этой суммы"})]}):n.jsxs("div",{className:"bg-muted/30 border-2 border-muted rounded-lg p-4 space-y-2",children:[n.jsx("p",{className:"text-xs font-bold text-muted-foreground uppercase",children:"Сумма для перевода:"}),n.jsx("p",{className:"text-3xl font-bold text-foreground font-mono",children:Number(r.payableAmount).toFixed(2)})]}),n.jsx("div",{className:"flex justify-center py-4",children:n.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm",children:n.jsx(Ce,{value:r.walletAddress,size:200,level:"H",includeMargin:!0})})}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("p",{className:"text-sm font-bold text-muted-foreground",children:"Адрес для пополнения:"}),n.jsx("div",{className:"p-4 bg-muted/50 rounded-lg break-all font-mono text-sm font-medium",children:r.walletAddress})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsx(I,{onClick:_,className:"gap-2 font-bold",variant:c?"secondary":"outline",children:c?n.jsxs(n.Fragment,{children:[n.jsx(Te,{className:"w-4 h-4"}),"Скопировано"]}):n.jsxs(n.Fragment,{children:[n.jsx(ae,{className:"w-4 h-4"}),"Скопировать"]})}),n.jsxs(I,{onClick:S,className:"gap-2 font-bold",variant:"outline",children:[n.jsx(Oe,{className:"w-4 h-4"}),"TronScan"]})]})]}),C?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"space-y-3",children:[n.jsx(I,{onClick:q,className:"w-full gap-2 min-h-[52px] rounded-xl gradient-primary text-white font-bold shadow-premium",children:"Я отправил перевод"}),n.jsx(I,{onClick:D,variant:"outline",className:"w-full gap-2 min-h-[52px] rounded-xl font-bold border-2 border-blue-300 text-blue-600 hover:bg-blue-50 hover:text-blue-700",children:"Создать новую заявку"}),n.jsx(I,{onClick:L,variant:"outline",className:"w-full gap-2 min-h-[52px] rounded-xl font-bold border-2 border-red-300 text-red-600 hover:bg-red-50 hover:text-red-700",children:"Отменить заявку"})]}),n.jsx(z,{className:"p-4 bg-muted/50 border-muted rounded-2xl",children:n.jsxs("p",{className:"text-sm text-muted-foreground",children:[n.jsx("strong",{children:"Важно:"})," Переведите ровно ",n.jsxs("strong",{children:[Number(r.payableAmount).toFixed(2)," USDT"]})," на указанный адрес. Средства будут автоматически зачислены после подтверждения в блокчейне (обычно 1-2 минуты)."]})})]}):n.jsx("div",{className:"space-y-3",children:n.jsx(I,{onClick:D,className:"w-full gap-2 min-h-[52px] rounded-xl gradient-primary text-white font-bold shadow-premium",children:"Создать новую заявку"})})]}),n.jsx(J,{open:R,onOpenChange:y,children:n.jsxs(ee,{className:"max-w-md",children:[n.jsxs(te,{children:[n.jsx(se,{className:"text-2xl font-bold text-center",children:"✅ Спасибо!"}),n.jsx(re,{className:"text-center text-base pt-2",children:"Ожидайте зачисления перевода в течении пары минут. Мы проверим транзакцию в блокчейне и автоматически зачислим средства на ваш баланс."})]}),n.jsx(ne,{className:"sm:justify-center",children:n.jsx(oe,{onClick:Y,className:"w-full sm:w-auto min-h-[48px] rounded-xl gradient-primary text-white font-bold shadow-premium",children:"Вернуться на главную"})})]})}),n.jsx(J,{open:p,onOpenChange:E,children:n.jsxs(ee,{className:"max-w-md",children:[n.jsxs(te,{children:[n.jsxs(se,{className:"text-2xl font-bold text-center flex items-center justify-center gap-2",children:[n.jsx(ie,{className:"w-6 h-6 text-orange-500"}),"Достигнут лимит"]}),n.jsx(re,{className:"text-center text-base pt-2",children:"У вас уже открыто 3 заявки на пополнение. Пожалуйста, оплатите их или отмените перед созданием новой заявки."})]}),n.jsxs(ne,{className:"sm:justify-center gap-2",children:[f&&n.jsxs(oe,{onClick:()=>{E(!1),f()},className:"w-full sm:w-auto min-h-[48px] rounded-xl gradient-primary text-white font-bold shadow-premium gap-2",children:[n.jsx(Fe,{className:"w-4 h-4"}),"Перейти к истории"]}),n.jsx(Me,{onClick:()=>E(!1),className:"w-full sm:w-auto min-h-[48px] rounded-xl font-bold",children:"Закрыть"})]})]})})]})}return null}export{ot as default};
